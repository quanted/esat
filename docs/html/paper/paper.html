
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Summary &#8212; Environmental Source Apportionment Toolkit (ESAT) 0.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=f6d3da1f"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'paper/paper';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Environmental Source Apportionment Toolkit (ESAT) 0.2 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Welcome to EPA’s ESAT Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Environmental Source Apportionment Toolkit (ESAT)</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../docs/modules.html">Python API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../docs/esat.html">esat package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../docs/esat.cli.html">esat.cli package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../docs/esat.data.html">esat.data package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../docs/esat.error.html">esat.error package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../docs/esat.model.html">esat.model package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../docs/esat.rotational.html">esat.rotational package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../docs/esat.data.html">esat.data package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../docs/esat.error.html">esat.error package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../docs/esat.model.html">esat.model package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../docs/esat.rotational.html">esat.rotational package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../docs/eval.html">eval package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/cli.html">Command Line Interface</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/paper/paper.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Summary</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Summary</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#statement-of-need">Statement of Need</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithms">Algorithms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#error-estimation">Error Estimation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgements">Acknowledgements</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h1>
<p>Source apportionment is an important tool in environmental science where sample or sensor data are often the product
of many, often unknown, contributing sources. Source apportionment is used to understand the relative contributions of
air sources [&#64;Bhandari:2022] like vehicle emissions, industrial activities, or dust. As well as particulate matter
pollution and to identify relative contributions of point sources and non-point sources in water bodies such as lakes,
rivers, and estuaries [&#64;Mamum:2021] [&#64;Jiang:2019]. Using non-negative matrix factorization(NMF), source apportionment
models estimate potential source profiles and contributions providing a cost-efficient method for further strategic data
collection or modeling.</p>
<p>Environmental Source Apportionment Toolkit (ESAT) is an open-source Python package that provides a flexible and
transparent workflow for source apportionment using NMF algorithms, developed to replace the EPA’s Positive
Matrix Factorization version 5 (PMF5) application [&#64;PMF5:2014] [&#64;Paatero:1999]. <code class="docutils literal notranslate"><span class="pre">ESAT</span></code> recreates the source apportionment
workflow of PMF5 including pre-post processing analytical tools, batch modeling, uncertainty estimations and customized
constraints. <code class="docutils literal notranslate"><span class="pre">ESAT</span></code> offers a simulator for generating datasets from synthetic profiles and contributions, allowing for
model output evaluation. The synthetic profiles can be randomly generated, use a pre-defined set of profiles, or be a
combination of the two. The random synthetic contributions can follow specified curves and value ranges. Running <code class="docutils literal notranslate"><span class="pre">ESAT</span></code>
using the synthetic datasets one is able to accurately assess ESAT’s ability to find a solution that recreates the
original synthetic profiles and contributions.</p>
</section>
<section id="statement-of-need">
<h1>Statement of Need<a class="headerlink" href="#statement-of-need" title="Link to this heading">#</a></h1>
<p>The EPA’s PMF5, released in 2014, provides a widely-used source apportionment modeling and analysis
workflow that is no longer supported and relies on the proprietary Multilinear Engine v2 (ME2). <code class="docutils literal notranslate"><span class="pre">ESAT</span></code> has been
developed as a replacement to PMF5, and has been designed for increased flexibility, documentation and transparency.</p>
<p>The Python API and CLI of <code class="docutils literal notranslate"><span class="pre">ESAT</span></code> provides a programmatic interface that can recreate the PMF5 workflow.
The matrix factorization algorithms in <code class="docutils literal notranslate"><span class="pre">ESAT</span></code> have been written in Rust for runtime optimization. The <code class="docutils literal notranslate"><span class="pre">ESAT</span></code> API and CLI
provides a flexible way to create source apportionment workflows and novel research applications. <code class="docutils literal notranslate"><span class="pre">ESAT</span></code> was developed for
environmental research, though it’s not limited to that domain, as matrix factorization is used in many different fields.</p>
<section id="algorithms">
<h2>Algorithms<a class="headerlink" href="#algorithms" title="Link to this heading">#</a></h2>
<p>Source apportionment algorithms use a loss function to quantify the difference between the input data matrix (V) and
the product of a factor contribution matrix (W) and a factor profile matrix (H), weighted by an uncertainty matrix (U)
[&#64;Paatero:1994]. The goal is to find factor matrices that best reproduce the input matrix, while constraining all,
or most of, the factor elements to be non-negative. The solution, W and H, can be used to calculate the
residuals and overall model loss. <code class="docutils literal notranslate"><span class="pre">ESAT</span></code> has two NMF algorithms for updating the profile and contribution matrices:
least-squares NMF (LS-NMF) [&#64;Wang:2006] and weighted-semi NMF (WS-NMF) [&#64;Ding:2008] [&#64;DeMelo:2012].</p>
<p>The loss function used in <code class="docutils literal notranslate"><span class="pre">ESAT</span></code>, and PMF5, is a variation of squared-error loss, where data uncertainty is taken into
consideration (both in the loss function and in the matrix update equations):</p>
<p>$$
Q = \sum_{i=1}^n \sum_{j=1}^m \bigg[ \frac{V_{ij} - \sum_{k=1}^K W_{ik} H_{kj}}{U_{ij}} \bigg]^2
$$
here $V$ is the input data matrix of features (columns=$M$) by samples (rows=$N$), $U$ is the uncertainty matrix of the
input data matrix, $W$ is the factor contribution matrix of samples by factors=$k$, $H$ is the factor profile of
factors by features.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ESAT</span></code> versions of NMF algorithms convert the uncertainty $U$ into weights defined as $Uw = \frac{1}{U^2}$.
The update equations for LS-NMF then become:</p>
<p>$$ H_{t+1} = H_t \circ \frac{W_t (V \circ Uw)}{W_t {((W_{t}H_{t}) \circ Uw)}} $$</p>
<p>$$ W_{t+1} = W_t \circ \frac{(V \circ Uw) H_{t+1}}{((W_{t}H_{t+1})\circ Uw )H_{t+1}} $$</p>
<p>while the update equations for WS-NMF:</p>
<p>$$ W_{t+1,i} = (H^{T}Uw_{i}^{d}H)^{-1}(H^{T}Uw_{i}^{d}V_{i})$$</p>
<p>$$ H_{t+1,i} = H_{t, i}\sqrt{\frac{((V^{T}Uw)W_{t+1})<em>{i}^{+} + [H</em>{t}(W_{t+1}^{T}Uw W)^{-}]<em>{i}}{((V^{T}Uw)W</em>{t+1})<em>{i}^{-} + [H</em>{t}(W_{t+1}^{T}Uw W)^{+}]_{i}}}$$</p>
<p>where $W^{-} = \frac{(|W| - W)}{2.0}$ and $W^{+} = \frac{(|W| + W)}{2.0}$.</p>
</section>
<section id="error-estimation">
<h2>Error Estimation<a class="headerlink" href="#error-estimation" title="Link to this heading">#</a></h2>
<p>An important part of the source apportionment workflow is quantifying potential model error. <code class="docutils literal notranslate"><span class="pre">ESAT</span></code> offers the error
estimation methods that were developed and made available in PMF5 [&#64;Brown:2015] [&#64;Paatero:2014].</p>
<p>The displacement method (DISP) determines the amount that a source profile feature, a single value in the H matrix,
must increase and decrease to cause targeted changes to the loss value. One or more features can be selected
in the DISP uncertainty analysis. The bootstrap method (BS) uses block bootstrap resampling with replacement to create
datasets with the original dimensions of the input, where the order of the samples has been modified in blocks of a
specified size. The BS method then calculates a new model from the bootstrap dataset, and original
initialization, to evaluate how the profiles and concentrations change as a result of sample reordering.
The bootstrap-displacement method (BS-DISP) is the combination of the two techniques, where DISP is run for each
bootstrap model on one or more features.</p>
<p>These error estimation methods address different uncertainty aspects: DISP targets rotational uncertainty, BS addresses
random errors and sample variability, and BS-DISP provides the most comprehensive understanding of how the uncertainty
impacts a source apportionment solution.</p>
</section>
</section>
<section id="acknowledgements">
<h1>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Link to this heading">#</a></h1>
<p>This paper has been reviewed in accordance with EPA policy and approved for publication.
ESAT development has been funded by U.S. EPA.  Mention of any trade names, products, or services does not convey, and
should not be interpreted as conveying, official EPA approval, endorsement, or recommendation. The views expressed in
this paper are those of the authors and do not necessarily represent the views or policies of the US EPA.</p>
</section>
<section id="references">
<h1>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h1>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Summary</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#statement-of-need">Statement of Need</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithms">Algorithms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#error-estimation">Error Estimation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgements">Acknowledgements</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Deron Smith
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, EPA.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>